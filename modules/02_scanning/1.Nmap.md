
# üîé Nmap Recon & Firewall Evasion Cheat Sheet 

## 1. Host Discovery

| **Use**           | **Command(s)**          | **Where It‚Äôs Used**                    |
| ----------------- | ----------------------- | -------------------------------------- |
| Ping Scan         | `nmap -sn 10.10.1.0/24` | Find live hosts in a subnet            |
| Disable Port Scan | `nmap -sn 10.10.1.5`    | Just check if host is up, no port scan |

---

## 2. Port Scanning

| **Use**        | **Command(s)**                   | **Where It‚Äôs Used**       |
| -------------- | -------------------------------- | ------------------------- |
| Common Ports   | `nmap 10.10.1.5`                 | Top 1000 ports            |
| All Ports      | `nmap -p- 10.10.1.5`             | Scan all 65535 ports      |
| Specific Ports | `nmap -p 21,22,80,443 10.10.1.5` | Targeted ports only       |
| Top N Ports    | `nmap --top-ports 50 10.10.1.5`  | Scan most common 50 ports |

---

## 3. Service & OS Detection

| **Use**         | **Command(s)**       | **Where It‚Äôs Used**              |
| --------------- | -------------------- | -------------------------------- |
| Service Version | `nmap -sV 10.10.1.5` | Identify services & versions     |
| Aggressive Scan | `nmap -A 10.10.1.5`  | OS, version, traceroute, scripts |
| OS Detection    | `nmap -O 10.10.1.5`  | Fingerprint target OS            |

nmap

## 4. Scan Techniques (Stealth/Evasion)

|**Use**|**Command(s)**|**Where It‚Äôs Used**|
|---|---|---|
|SYN (Stealth)|`nmap -sS 10.10.1.5`|Quiet scan, bypass some firewalls|
|TCP Connect|`nmap -sT 10.10.1.5`|When SYN blocked|
|UDP Scan|`nmap -sU 10.10.1.5`|Discover UDP services|
|FIN Scan|`nmap -sF 10.10.1.5`|Evasion using FIN flag|
|Xmas Scan|`nmap -sX 10.10.1.5`|Evasion using Xmas packets|
|Null Scan|`nmap -sN 10.10.1.5`|Evasion using no flags|

---

## 5. Firewall / IDS Evasion

|**Use**|**Command(s)**|**Where It‚Äôs Used**|
|---|---|---|
|Fragment Packets|`nmap -f 10.10.1.5`|Split packets to bypass firewalls|
|Custom MTU|`nmap --mtu 24 10.10.1.5`|Fine-tune packet fragmentation|
|Decoy Scan|`nmap -D RND:10 10.10.1.5`|Hide your IP among fake sources|
|Source Port|`nmap --source-port 53 10.10.1.5`|Masquerade as DNS traffic|
|Idle/Zombie Scan|`nmap -sI zombie_host 10.10.1.5`|Hide attacker IP using third host|
|Timing Slow|`nmap -T2 10.10.1.5`|Avoid IDS by slowing down scan|
|Timing Fast|`nmap -T5 10.10.1.5`|Quick, noisy scan|
|MAC Spoofing|`nmap --spoof-mac 0 10.10.1.5`|Evade MAC-based firewall rules|

---

## 6. NSE (Nmap Scripting Engine)

|**Use**|**Command(s)**|**Where It‚Äôs Used**|
|---|---|---|
|Default Scripts|`nmap -sC 10.10.1.5`|Common service/vuln checks|
|Vuln Scripts|`nmap --script vuln 10.10.1.5`|Quick vulnerability scan|
|HTTP Enum|`nmap --script http-title 10.10.1.5`|Enumerate web apps|
|SMB Enum|`nmap --script smb-os-discovery 10.10.1.5`|Discover SMB & OS info|

---

## 7. Output & Reporting

|**Use**|**Command(s)**|**Where It‚Äôs Used**|
|---|---|---|
|Normal Output|`nmap -oN scan.txt 10.10.1.5`|Human-readable output|
|Grepable Output|`nmap -oG scan.gnmap 10.10.1.5`|For parsing with grep/awk|
|XML Output|`nmap -oX scan.xml 10.10.1.5`|For tools like Nessus, OpenVAS|
|All Formats|`nmap -oA result 10.10.1.5`|Saves in `.nmap`, `.gnmap`, `.xml`|

## Reduce Noise 

#### Why Nmap is ‚ÄúNoisy‚Äù

- **Generates noticeable traffic:**
    
    - A single Nmap scan can send thousands of packets quickly.
        
    - IDS/IPS and firewalls can easily log or trigger alerts.
        
- **Default scans (like `nmap target`) probe 1000 ports** ‚Üí this looks unusual in normal network traffic.
    
- **Aggressive scans (`-A`, `-T4`, `-T5`)** are very loud ‚Üí they include OS detection, traceroute, service probes, and NSE scripts.
    
- **Signature-based detection:**
    
    - Tools like Snort, Suricata, and SIEM solutions already have rules that flag Nmap scans.
        
    - Even stealth techniques (`-sS`, `-sF`, `-sX`) are well known and often detected.



## üîï How to Reduce Noise (Stealthier Scanning)
        

|                     |                                       |                                |
| ------------------- | ------------------------------------- | ------------------------------ |
| - **slower timing** | `nmap -T1 10.10.1.5`                  | (very slow, harder to detect). |
| - **Limit ports**   | `nmap -p 22,80,443 10.10.1.5`         | (instead of full 65535 scan).  |
| - **fragmentation** | `nmap -f 10.10.1.5`                   |                                |
| - Randomize targets | `nmap --randomize-hosts 10.10.1.0/24` |                                |
- Use **Idle/Zombie scan** (`-sI`) ‚Üí hides your IP, less obvious.



## üîë Takeaway

- **Yes, Nmap = noisy** (easy to detect in blue team monitoring).
    
- But it‚Äôs also **powerful & fast**, which is why red teamers/pentesters still use it for recon.
    
- For **stealthy engagements**, pros sometimes use **alternative tools** (e.g., `masscan`, `unicornscan`, or custom scripts), or blend scans into normal traffic.