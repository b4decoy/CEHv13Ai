# **hping3 Firewall Testing Cheatsheet**

|**Goal**|**hping3 Command**|**Used In Place of Nmap**|**Purpose / When Used**|
|---|---|---|---|
|**Ping (host discovery)**|`hping3 -S -p 80 <target>`|`nmap -sn <target>`|If ICMP (ping) is blocked, send a **TCP SYN** to port 80 to check if host is alive.|
|**Stealth Port Scan (one port)**|`hping3 -S -p 22 <target>`|`nmap -p 22 <target>`|Test if SSH port is open without triggering large scans.|
|**Port Range Scan**|`hping3 -S -p ++1 -c 1 <target>`|`nmap -p 1-1000 <target>`|Increment ports manually (using `++1`) to check allowed/blocked ports.|
|**Service Reachability Test**|`hping3 -S -p 443 <target>`|`nmap -p 443 <target>`|Validate if HTTPS port is allowed through firewall.|
|**Bypass ICMP Filter**|`hping3 -A -p 80 <target>`|`nmap -sn -PS80 <target>`|Use TCP ACK instead of ICMP to discover live hosts behind firewall.|
|**Outbound Filtering Test**|`hping3 -S -p 21 <remote-host>`|`nmap -p 21 <remote-host>`|From inside a network, check if outbound FTP (21) traffic is allowed.|
|**Traceroute Alternative**|`hping3 --traceroute -V -S -p 80 <target>`|`nmap --traceroute <target>`|Map firewall hops when ICMP traceroute is blocked.|
|**SYN Flood Simulation**|`hping3 -S -p 80 --flood <target>`|_(Not possible directly in Nmap)_|Simulate DDoS traffic ‚Üí used by Blue Teams to test firewall load.|
|**FIN/NULL/Xmas Evasion**|`hping3 -F -p 80 <target>`|`nmap -sF <target>`|Send unusual flags to test how firewall/IDS handles non-standard packets.|
|**Custom Packet Crafting**|`hping3 -c 1 -S -p 8080 -a <spoofed-IP> <target>`|_(Nmap limited)_|Test firewall spoofing rules & anti-spoof protections.|

---

‚úÖ **Key Takeaway**:

- Nmap = **fast, noisy, bulk scanning**.
    
- hping3 = **stealthy, custom, firewall/packet-focused testing**.
    
- In **real environments**, hping3 is used when you want **precision and stealth** (without alerting SOC too quickly).'


## üî• Why hping3 is Mostly Used for Firewall Testing

1. **Nmap is noisy** ‚Üí Firewalls/IDS log big scans immediately.  
    üîπ hping3 can send _single crafted packets_ slowly ‚Üí better for **stealthy firewall rule testing**.
    
2. **Firewall Rule Validation**
    
    - Example: Bank/enterprise firewall says ‚Äúonly allow 80/443 inbound.‚Äù
        
    - With hping3, a pentester can test if **other ports still respond** by crafting custom packets.
        
3. **Outbound Traffic Testing**
    
    - Many companies allow only limited outbound ports (80, 443).
        
    - From inside, hping3 is used to see if a **reverse shell** could escape on other ports.
        
4. **Bypass ICMP Block**
    
    - Firewalls often block ICMP echo (`ping`).
        
    - hping3 can use TCP SYN/ACK/FIN as a **ping alternative** to discover live hosts.
        
5. **DDoS / Flood Simulation (with permission)**
    
    - Security teams use hping3 to simulate SYN floods, UDP floods ‚Üí test firewall load balancing.
        

---

## ‚úÖ Real Firewall-Side Scenarios

- **Pentesters** ‚Üí map which ports are allowed/blocked, test filtering policies.
    
- **Red Teamers** ‚Üí use it instead of Nmap when stealth is needed.
    
- **Blue Teams (SOC/IR)** ‚Üí simulate packet floods & evasion traffic to **tune firewall/IDS rules**.
    
- **Cloud Security Audits** ‚Üí test AWS/Azure/GCP firewall/security groups.